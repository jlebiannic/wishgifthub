version: "3.9"

services:
  backend:
    container_name: wishgifthub-backend
    #image: jlebiannic/wishgifthub-backend:latest
    build:
      context: .                 # racine du projet, o√π est le Dockerfile backend
      dockerfile: Dockerfile
    env_file:
      - /home/debian/config/wishgifthub/.env
    networks:
      - wishgifthub-net
    ports:
      - "8080"
    restart: unless-stopped

  frontend:
    container_name: wishgifthub-frontend
    #image: jlebiannic/wishgifthub-frontend:latest
    build:
      context: ./wishgifthub-ui  # dossier du frontend Vue.js
      dockerfile: Dockerfile     # Dockerfile du front dans ce dossier
    depends_on:
      - backend
    networks:
      - wishgifthub-net
    ports:
      - "80"
    restart: unless-stopped

  nginx:
      image: nginx:latest
      container_name: wishgifthub-nginx
      volumes:
        - ./nginx/conf.d:/etc/nginx/conf.d
        - ./certbot/www:/var/www/certbot
        - /etc/letsencrypt:/etc/letsencrypt
      ports:
        - "80:80"
        - "443:443"
      depends_on:
        - frontend
      networks:
        - wishgifthub-net
      restart: unless-stopped

networks:
  wishgifthub-net:
    driver: bridge
