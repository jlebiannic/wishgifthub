meta {
  name: 16b. Test de sécurité - User réserve son propre souhait (doit échouer)
  type: http
  seq: 17
}

post {
  url: {{base_url}}/api/groups/{{group_id}}/wishes/{{wish_id_for_security_test}}/reserve
  body: none
  auth: bearer
}

auth:bearer {
  token: {{user_token}}
}

tests {
  test("Étape 16b (Sécurité): User ne peut pas réserver son propre souhait - Status 400 ou 403", function() {
    expect(res.getStatus()).to.be.oneOf([400, 403]);
  });
}

script:post-response {
  if (res.status === 400 || res.status === 403) {
    console.log("✅ ÉTAPE 16b: Sécurité OK - User ne peut pas réserver son propre souhait");
  } else {
    console.log("❌ ÉTAPE 16b ÉCHOUÉE: Sécurité - User peut réserver son propre souhait!");
  }
}

